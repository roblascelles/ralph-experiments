services:
  ralph-agent:
    build: .
    container_name: ralph_sandbox
    # Ensure we can use interactive features like tmux and gh auth
    stdin_open: true 
    tty: true
    volumes:
      # Mount your current project folder into the sandbox
      - .:/home/ralph/workspace
    deploy:
      resources:
        limits:
          cpus: '2.0'
          memory: 4G      
    environment:
      - PYTHONUNBUFFERED=1
      - GH_TOKEN=${GH_TOKEN}
    # This keeps the container alive so you can exec into it
    command: /bin/bash -c "tmux new-session -s ralph_loop 'echo Ralph Sandbox Ready!; /bin/bash'"